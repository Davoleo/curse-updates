"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Utils=void 0;var fs=require("fs");var MessageEmbed=require("discord.js/typings").MessageEmbed;var query_1=require("./query");var cfg_json_1=require("../cfg.json");var embedColors=["404040","FEBC11","F26122"];var releaseColors={Alpha:"ED493E",Beta:"0E9BD8",Release:"14B866"};var Utils=function(){function Utils(){}Utils.savePrefix=function(prefix){cfg_json_1.default.prefix=prefix;this.updateJSONConfig()};Utils.addProjectToConfig=function(guildId,projectId){cfg_json_1.default.serverConfig[guildId].projects.push(projectId);this.updateJSONConfig()};Utils.initSaveGuild=function(id){if(!(id in cfg_json_1.default.serverConfig)){console.log("GUILD INIT");cfg_json_1.default.serverConfig[id]={releasesChannel:"none",projects:[]};this.updateJSONConfig()}};Utils.updateJSONConfig=function(){fs.writeFile("./cfg.json",JSON.stringify(cfg_json_1.default,null,2),function writeJSON(e){if(e){return console.log(e)}})};Utils.createEmbed=function(description,title){if(description===void 0){description=""}if(title===void 0){title=""}var embed=new MessageEmbed;if(title!==""){embed.setTitle(title)}if(description!==""){embed.setDescription(description)}embed.setColor(embedColors[Math.ceil(Math.random()*3)]);return embed};Utils.buildScheduleEmbed=function(guildId){var idNamePairs=[];cfg_json_1.default.serverConfig[guildId].projects.forEach(function(projectId){var mod=query_1.cfquery.getModById(projectId);idNamePairs.push({name:projectId,value:mod!==null?mod.name:"error"})});var embed=new MessageEmbed;embed.setColor(embedColors[Math.ceil(Math.random()*3)]);embed.addField("Annoucements Channel:",cfg_json_1.default.serverConfig[guildId].releasesChannel);if(idNamePairs.length>0){embed.addFields(idNamePairs)}else{embed.setTitle("No Projects have been Scheduled on this server")}return embed};Utils.buildModEmbed=function(mod,modFile){var modEmbed=new MessageEmbed;var releaseTypeString=this.getTypeStringFromId(modFile.release_type);var splitUrl=modFile.download_url.split("/");var fileName=splitUrl[splitUrl.length-1];var authorString="";for(var i=0;i<mod.authors.length;i++){var author=mod.authors[i];authorString+="["+author.name+"]("+author.url+"), "}modEmbed.setTitle("New "+mod.name+" "+releaseTypeString+"!").setURL(mod.url);modEmbed.setDescription(mod.summary);modEmbed.addField("Authors",authorString);modEmbed.setColor(releaseColors[releaseTypeString]);modEmbed.setThumbnail(mod.logo.url);modEmbed.addField("Minecraft Versions",modFile.minecraft_versions.join(", "));modEmbed.addField("New Mod Version",fileName);modEmbed.addField("Type",releaseTypeString);modEmbed.addField("Links","[Download]("+modFile.download_url.replace(/ /g,"%20")+")\n[CurseForge]("+mod.url+")");console.log(mod.authors[0]);modEmbed.setTimestamp(modFile.timestamp);console.log(modFile);return modEmbed};Utils.getTypeStringFromId=function(typeId){switch(typeId){case 1:return"Release";case 2:return"Beta";case 3:return"Alpha";default:return"NO"}};return Utils}();exports.Utils=Utils;
